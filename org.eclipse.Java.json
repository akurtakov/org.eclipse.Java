{
    "id": "org.eclipse.Java",
    "runtime": "org.gnome.Platform",
    "runtime-version": "49",
    "sdk": "org.gnome.Sdk",
    "sdk-extensions": [],
    "command": "eclipse",
    "finish-args": [
        "--require-version=1.7.1",
        "--filesystem=host",
        "--filesystem=/tmp:rw",
        "--persist=.eclipse",
        "--share=network",
        "--share=ipc",
        "--allow=devel",
        "--socket=session-bus",
        "--device=dri",
        "--socket=wayland",
        "--socket=fallback-x11",
        "--socket=ssh-auth",
        "--talk-name=org.freedesktop.secrets"
    ],
    "modules": [
        {
            "name": "gdk-pixbuf",
            "buildsystem": "meson",
            "config-opts": [
                "-Dothers=enabled",
                "-Dman=false",
                "-Ddocumentation=false",
                "-Dtests=false",
                "-Dinstalled_tests=false",
                "-Dbuiltin_loaders=all"
            ],
            "sources": [
                {
                    "type": "git",
                    "url": "https://gitlab.gnome.org/GNOME/gdk-pixbuf.git",
                    "tag": "2.44.1"
                }
            ]
        },
        {
            "name": "eclipse",
            "buildsystem": "simple",
            "build-options": {
                "no-debuginfo": true
            },
            "build-commands": [
                "mv eclipse /app",
                "mkdir -p /app/bin",
                "ln -s /app/eclipse/eclipse /app/bin",
                "install -Dm 644 org.eclipse.Java.desktop /app/share/applications/org.eclipse.Java.desktop",
                "install -Dm 644 org.eclipse.Java.metainfo.xml /app/share/metainfo/org.eclipse.Java.metainfo.xml",
                "install -Dm 644 flatpak-dev-shim-1.0.1-SNAPSHOT.jar /app/eclipse/flatpak-dev-shim.jar",
                "install -Dm 644 flatpak-dev-shim-1.0.1-SNAPSHOT.so /app/lib/libflatpakdevshim.so",
                "mkdir -p /app/share/icons/hicolor/32x32/apps",
                "if [ -f /app/eclipse/plugins/org.eclipse.platform_*/eclipse32.png ] ; then cp -p /app/eclipse/plugins/org.eclipse.platform_*/eclipse32.png /app/share/icons/hicolor/32x32/apps/org.eclipse.Java.png ; fi",
                "mkdir -p /app/share/icons/hicolor/64x64/apps",
                "if [ -f /app/eclipse/plugins/org.eclipse.platform_*/eclipse64.png ] ; then cp -p /app/eclipse/plugins/org.eclipse.platform_*/eclipse64.png /app/share/icons/hicolor/64x64/apps/org.eclipse.Java.png ; fi",
                "mkdir -p /app/share/icons/hicolor/128x128/apps",
                "if [ -f /app/eclipse/plugins/org.eclipse.platform_*/eclipse128.png ] ; then cp -p /app/eclipse/plugins/org.eclipse.platform_*/eclipse128.png /app/share/icons/hicolor/128x128/apps/org.eclipse.Java.png ; fi",
                "mkdir -p /app/share/icons/hicolor/256x256/apps",
                "if [ -f /app/eclipse/plugins/org.eclipse.platform_*/eclipse256.png ] ; then cp -p /app/eclipse/plugins/org.eclipse.platform_*/eclipse256.png /app/share/icons/hicolor/256x256/apps/org.eclipse.Java.png ; fi",
                "sed -i -e '/osgi.configuration.area/d' /app/eclipse/eclipse.ini",
                "echo \"-Dosgi.configuration.area=@user.home/.var/app/org.eclipse.Java/eclipse/configuration\" >> /app/eclipse/eclipse.ini",
                "echo \"--patch-module=java.base=/app/eclipse/flatpak-dev-shim.jar\" >> /app/eclipse/eclipse.ini",
                "echo \"-Dsun.boot.library.path=/app/lib\" >> /app/eclipse/eclipse.ini"
            ],
            "sources": [
                {
                    "type": "archive",
                    "only-arches": [
                        "x86_64"
                    ],
                    "url": "https://download.eclipse.org/technology/epp/downloads/release/2025-09/R/eclipse-java-2025-09-R-linux-gtk-x86_64.tar.gz",
                    "sha512": "6842f02c8079f67704e9b24417fe58a1cf2cb510f30e76553a67549d6b63ef9ab3bd892103c98c73bae1f6cdcb6479a977fc2a3691a877f97cd171a31e50ce48",
                    "strip-components": 0,
                    "x-checker-data": {
                        "type": "html",
                        "url": "https://download.eclipse.org/technology/epp/downloads/release/release.xml",
                        "version-pattern": "<present>(\\d{4}-\\d{2})/R</present>",
                        "url-template": "https://download.eclipse.org/technology/epp/downloads/release/$version/R/eclipse-java-$version-R-linux-gtk-x86_64.tar.gz"
                    }
                },
                {
                    "type": "archive",
                    "only-arches": [
                        "aarch64"
                    ],
                    "url": "https://download.eclipse.org/technology/epp/downloads/release/2025-09/R/eclipse-java-2025-09-R-linux-gtk-aarch64.tar.gz",
                    "sha512": "df248798676df3c6d65f13f8c5dd8700403a1e55d46e27a41e2792268d67537913d85ae53509589a6f52a81f435c5649d2ce7e17e0aad8b24cdfee9c801fc7db",
                    "strip-components": 0,
                    "x-checker-data": {
                        "type": "html",
                        "url": "https://download.eclipse.org/technology/epp/downloads/release/release.xml",
                        "version-pattern": "<present>(\\d{4}-\\d{2})/R</present>",
                        "url-template": "https://download.eclipse.org/technology/epp/downloads/release/$version/R/eclipse-java-$version-R-linux-gtk-aarch64.tar.gz"
                    }
                },
                {
                    "type": "file",
                    "url": "https://repo.eclipse.org/content/repositories/linuxtools/org/eclipse/linuxtools/flatpak/flatpak-dev-shim/1.0.1-SNAPSHOT/flatpak-dev-shim-1.0.1-20250722.150010-10.jar",
                    "sha256": "1a421e396bf43d423d64d2943aea4900d142749d58a7ea5fb777a484049a2271",
                    "dest-filename": "flatpak-dev-shim-1.0.1-SNAPSHOT.jar"
                },
                {
                    "type": "file",
                    "url": "https://repo.eclipse.org/content/repositories/linuxtools/org/eclipse/linuxtools/flatpak/flatpak-dev-shim/1.0.1-SNAPSHOT/flatpak-dev-shim-1.0.1-20250722.150010-10.so",
                    "sha256": "6460250a44558e8ccb475705a40273eb0065e8cf746839ff5f502fc184d2c3df",
                    "dest-filename": "flatpak-dev-shim-1.0.1-SNAPSHOT.so"
                },
                {
                    "type": "file",
                    "path": "org.eclipse.Java.desktop",
                    "dest-filename": "org.eclipse.Java.desktop"
                },
                {
                    "type": "file",
                    "path": "org.eclipse.Java.metainfo.xml",
                    "dest-filename": "org.eclipse.Java.metainfo.xml"
                }
            ]
        }
    ]
}
